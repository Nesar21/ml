from sklearn.datasets import load_iris
from sklearn.cluster import AgglomerativeClustering
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt

# Load and reduce dimensions
X = PCA(n_components=2).fit_transform(load_iris().data)

# Clustering
labels_single = AgglomerativeClustering(n_clusters=3, linkage='single').fit_predict(X)
labels_complete = AgglomerativeClustering(n_clusters=3, linkage='complete').fit_predict(X)

# Plotting
plt.figure(figsize=(10, 4))

plt.subplot(1, 2, 1)
plt.scatter(X[:, 0], X[:, 1], c=labels_single, cmap='viridis', edgecolor='k')
plt.title("Single Linkage")

plt.subplot(1, 2, 2)
plt.scatter(X[:, 0], X[:, 1], c=labels_complete, cmap='Set2', edgecolor='k')
plt.title("Complete Linkage")

plt.suptitle("Agglomerative Clustering on Iris Dataset", fontsize=14)
plt.tight_layout()
plt.show()
